import{j as e}from"./vendor-radix-ByHbWxx8.js";import{c as E,a as f}from"./vendor-react-BF0FEgLq.js";import{c as _,u as P,a as L,X as N,B as v,D as V,b as A,d as B,e as D,f as Y,g as Q,h as W,i as Z,j as ee}from"./index-0aCTP9xq.js";import{I as se}from"./input-BzJ4CQH1.js";import{S as k,a as C,b as I,c as S,d}from"./select-DBeyWshw.js";import{B as g,S as q}from"./badge-WuK-6-Ms.js";import{G as ae,D as te}from"./DataTablePagination-Dg7qy-0E.js";import{u as H,P as le,f as F}from"./usePersonnelFormatters-CJjfAr4B.js";import{C as T,a as ne,b as ie,c as M}from"./card-Dst-uUJd.js";import{S as re}from"./shield-DV-e7VlL.js";import{D as ce}from"./download-CHPCMnZd.js";import{R as oe}from"./refresh-cw-BDNQxtzz.js";import"./vendor-charts-3qJ5OAaG.js";import"./label-X5ZxR2EB.js";import"./chevron-left-BUxVMVdO.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],G=_("ellipsis-vertical",de);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],J=_("eye",xe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],he=_("funnel",me);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],pe=_("search",ue);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],ge=_("settings-2",je);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],_e=_("user-plus",ve);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ne=_("user",fe);function ye({filters:s,onClearFilter:i}){var n,p,j;const{t:l}=P(),{units:m,positions:h,roles:u}=L();return Object.values(s).filter(c=>c!==void 0).length===0?null:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.unitId&&e.jsxs(g,{variant:"secondary",children:[l("filters_unit"),": ",(n=m.find(c=>c.id===s.unitId))==null?void 0:n.abbreviation,e.jsx("button",{onClick:()=>i("unitId"),className:"ml-2 hover:text-destructive",children:e.jsx(N,{className:"w-3 h-3"})})]}),s.positionId&&e.jsxs(g,{variant:"secondary",children:[l("filters_position"),": ",(p=h.find(c=>c.id===s.positionId))==null?void 0:p.name,e.jsx("button",{onClick:()=>i("positionId"),className:"ml-2 hover:text-destructive",children:e.jsx(N,{className:"w-3 h-3"})})]}),s.roleId&&e.jsxs(g,{variant:"secondary",children:[l("filters_role"),": ",(j=u.find(c=>c.id===s.roleId))==null?void 0:j.name,e.jsx("button",{onClick:()=>i("roleId"),className:"ml-2 hover:text-destructive",children:e.jsx(N,{className:"w-3 h-3"})})]}),s.status&&e.jsxs(g,{variant:"secondary",children:[l("filters_status"),": ",s.status==="Служить"?l("filters_status_serving"):s.status==="Переведений"?l("filters_status_transferred"):s.status==="Звільнений"?l("filters_status_dismissed"):s.status,e.jsx("button",{onClick:()=>i("status"),className:"ml-2 hover:text-destructive",children:e.jsx(N,{className:"w-3 h-3"})})]}),s.serviceType&&e.jsxs(g,{variant:"secondary",children:[l("filters_service_type"),": ",s.serviceType==="Контракт"?l("filters_service_contract"):s.serviceType==="Мобілізований"?l("filters_service_mobilized"):s.serviceType,e.jsx("button",{onClick:()=>i("serviceType"),className:"ml-2 hover:text-destructive",children:e.jsx(N,{className:"w-3 h-3"})})]})]})}function be({filters:s,onFiltersChange:i,actionSlot:l}){const{units:m,positions:h,roles:u}=L(),{t:r}=P(),n=a=>{i({...s,search:a||void 0})},p=a=>{i({...s,unitId:a==="all"?void 0:a})},j=a=>{i({...s,positionId:a==="all"?void 0:a})},c=a=>{i({...s,status:a==="all"?void 0:a})},y=a=>{i({...s,serviceType:a==="all"?void 0:a})},t=a=>{i({...s,[a]:void 0})},x=a=>{i({...s,roleId:a==="all"?void 0:a})},z=()=>{i({})},b=Object.values(s).filter(a=>a!==void 0).length,$=m.filter(a=>a.parentId==="3");return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(se,{placeholder:r("filters_search_placeholder"),className:"pl-12",value:s.search||"",onChange:a=>n(a.target.value)})]}),b>0&&e.jsxs(v,{variant:"outline",onClick:z,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),r("filters_clear")," (",b,")"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:r("filters_title")})]}),e.jsxs(k,{value:s.unitId||"all",onValueChange:p,children:[e.jsx(C,{className:"w-[200px]",children:e.jsx(I,{placeholder:r("filters_unit")})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:r("filters_all_units")}),$.map(a=>e.jsxs(d,{value:a.id,children:[a.abbreviation," - ",a.name]},a.id))]})]}),e.jsxs(k,{value:s.positionId||"all",onValueChange:j,children:[e.jsx(C,{className:"w-[200px]",children:e.jsx(I,{placeholder:r("filters_position")})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:r("filters_all_positions")}),h.map(a=>e.jsx(d,{value:a.id,children:a.name},a.id))]})]}),e.jsxs(k,{value:s.roleId||"all",onValueChange:x,children:[e.jsx(C,{className:"w-[200px]",children:e.jsx(I,{placeholder:r("filters_role")})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:r("filters_all_roles")}),u.map(a=>e.jsx(d,{value:a.id,children:a.name},a.id))]})]}),e.jsxs(k,{value:s.status||"all",onValueChange:c,children:[e.jsx(C,{className:"w-[180px]",children:e.jsx(I,{placeholder:r("filters_status")})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:r("filters_all_statuses")}),e.jsx(d,{value:"Служить",children:r("filters_status_serving")}),e.jsx(d,{value:"Переведений",children:r("filters_status_transferred")}),e.jsx(d,{value:"Звільнений",children:r("filters_status_dismissed")})]})]}),e.jsxs(k,{value:s.serviceType||"all",onValueChange:y,children:[e.jsx(C,{className:"w-[180px]",children:e.jsx(I,{placeholder:r("filters_service_type")})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:r("filters_all_service_types")}),e.jsx(d,{value:"Контракт",children:r("filters_service_contract")}),e.jsx(d,{value:"Мобілізований",children:r("filters_service_mobilized")})]})]}),l&&e.jsx("div",{className:"ml-auto",children:l})]}),b>0&&e.jsx(ye,{filters:s,onClearFilter:t})]})}function we({person:s}){const i=E(),{t:l}=P(),{getUnitName:m,getPositionName:h,getStatusBadge:u,getServiceTypeBadge:r}=H();return e.jsxs(T,{className:"cursor-pointer hover:border-primary transition-colors bg-card overflow-hidden",onClick:()=>i(`/personnel/${s.id}`),children:[e.jsx(ne,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-mono font-bold text-lg text-primary",children:s.callsign})]}),e.jsx("div",{className:"text-xs text-muted-foreground font-medium mt-0.5 uppercase tracking-wider",children:s.rank})]}),e.jsx(ie,{children:e.jsxs(V,{children:[e.jsx(A,{asChild:!0,onClick:n=>n.stopPropagation(),children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(G,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsxs(B,{align:"end",children:[e.jsxs(D,{onClick:n=>{n.stopPropagation(),i(`/personnel/${s.id}`)},children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),l("table_action_view")]}),e.jsxs(D,{onClick:n=>{n.stopPropagation(),i(`/personnel/${s.id}/edit`)},children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),l("table_action_edit")]})]})]})})]})}),e.jsxs(M,{className:"p-4 pt-1 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-foreground font-semibold mb-1",children:[e.jsx(Ne,{className:"w-4 h-4 text-muted-foreground"}),s.fullName]}),s.militaryId&&e.jsxs("div",{className:"text-xs text-muted-foreground ml-6",children:["ID: ",s.militaryId]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 bg-muted/50 p-3 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:l("table_col_unit")}),e.jsx("span",{className:"font-medium text-foreground",children:m(s.unitId)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:l("table_col_position")}),e.jsx("span",{className:"font-medium text-foreground text-right",children:h(s.positionId)})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r(s.serviceType),u(s.status)]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground pt-3 border-t border-border",children:[e.jsx(le,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono",children:F(s.phone)})]})]})]})}function ke({personnel:s,visibleColumns:i}){const{t:l}=P(),m=E(),{getUnitName:h,getPositionName:u,getRoleName:r,getStatusBadge:n,getServiceTypeBadge:p}=H(),j=t=>i.includes(t),c=[{id:"callsign",header:l("table_col_callsign"),render:t=>e.jsx("span",{className:"font-mono font-medium text-primary",children:t.callsign})},{id:"fullname",header:l("table_col_fullname"),render:t=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:t.fullName}),t.militaryId&&e.jsx("div",{className:"text-xs text-muted-foreground",children:t.militaryId})]})},{id:"rank",header:l("table_col_rank"),render:t=>e.jsx("span",{className:"text-sm",children:t.rank})},{id:"unit",header:l("table_col_unit"),render:t=>e.jsx("span",{className:"text-sm",children:h(t.unitId)})},{id:"position",header:l("table_col_position"),render:t=>e.jsx("span",{className:"text-sm",children:u(t.positionId)})},{id:"roles",header:l("table_col_roles"),render:t=>e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.roleIds.slice(0,2).map(x=>e.jsx(g,{variant:"outline",className:"text-xs",children:r(x)},x)),t.roleIds.length>2&&e.jsxs(g,{variant:"outline",className:"text-xs",children:["+",t.roleIds.length-2]})]})},{id:"service_type",header:l("table_col_service_type"),render:t=>p(t.serviceType)},{id:"status",header:l("table_col_status"),render:t=>n(t.status)},{id:"phone",header:l("table_col_phone"),render:t=>e.jsx("span",{className:"text-sm font-mono",children:F(t.phone)})}].filter(t=>j(t.id)),y=t=>e.jsxs(V,{children:[e.jsx(A,{asChild:!0,onClick:x=>x.stopPropagation(),children:e.jsx(v,{variant:"ghost",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs(B,{align:"end",children:[e.jsxs(D,{onClick:x=>{x.stopPropagation(),m(`/personnel/${t.id}`)},children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),l("table_action_view")]}),e.jsxs(D,{onClick:x=>{x.stopPropagation(),m(`/personnel/${t.id}/edit`)},children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),l("table_action_edit")]})]})]});return e.jsx(ae,{data:s,columns:c,onRowClick:t=>m(`/personnel/${t.id}`),renderMobileCard:t=>e.jsx(we,{person:t}),renderActions:y,emptyMessage:l("table_no_results"),idField:"id"})}const R=["callsign","fullname","rank","unit","position","roles","service_type","status","phone"];function U({className:s,...i}){return e.jsx("div",{"data-slot":"skeleton",className:Y("bg-accent animate-pulse rounded-md",s),...i})}const O="personnel-table-columns";function Oe(){const s=E(),{filteredPersonnel:i,filters:l,setFilters:m,loading:h,error:u,reload:r}=Q(),{t:n}=P(),[p,j]=f.useState(1),[c,y]=f.useState(()=>{if(typeof window>"u")return 10;const o=localStorage.getItem("personnel-page-size");return o?parseInt(o,10):10});f.useEffect(()=>{localStorage.setItem("personnel-page-size",c.toString())},[c]),f.useEffect(()=>{j(1)},[l]);const[t,x]=f.useState(()=>{if(typeof window>"u")return R;const o=localStorage.getItem(O);return o?JSON.parse(o):R});f.useEffect(()=>{localStorage.setItem(O,JSON.stringify(t))},[t]);const z=o=>{x(w=>w.includes(o)?w.filter(X=>X!==o):[...w,o])},b=o=>t.includes(o),$=[{id:"callsign",label:n("table_col_callsign")},{id:"fullname",label:n("table_col_fullname")},{id:"rank",label:n("table_col_rank")},{id:"unit",label:n("table_col_unit")},{id:"position",label:n("table_col_position")},{id:"roles",label:n("table_col_roles")},{id:"service_type",label:n("table_col_service_type")},{id:"status",label:n("table_col_status")},{id:"phone",label:n("table_col_phone")}],a=Math.ceil(i.length/c),K=i.slice((p-1)*c,p*c);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-semibold text-foreground",children:n("registry_title")}),e.jsx("div",{className:"text-muted-foreground mt-1",children:h?e.jsx(U,{className:"h-4 w-32 inline-block"}):e.jsxs(e.Fragment,{children:[n("registry_found")," ",e.jsx("span",{className:"font-medium",children:i.length})," ",n("registry_records")]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ce,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:n("common_export")})]}),e.jsxs(v,{onClick:()=>s("/personnel/new"),children:[e.jsx(_e,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:n("registry_add_person")})]})]})]}),e.jsx(T,{children:e.jsx(M,{className:"pt-6",children:e.jsx(be,{filters:l,onFiltersChange:m})})}),h?e.jsx(T,{children:e.jsx(M,{className:"py-8 space-y-3",children:[1,2,3,4,5].map(o=>e.jsx(U,{className:"h-12 w-full"},o))})}):u?e.jsx(T,{children:e.jsxs(M,{className:"py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:u}),e.jsxs(v,{onClick:r,variant:"outline",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),n("registry_retry")]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(ke,{personnel:K,visibleColumns:t}),a>0&&e.jsx(te,{currentPage:p,setCurrentPage:j,pageSize:c,setPageSize:y,totalPages:a,actions:e.jsxs(V,{children:[e.jsx(A,{asChild:!0,children:e.jsxs(v,{variant:"outline",size:"sm",className:"gap-2 h-9",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:n("table_columns")})]})}),e.jsxs(B,{align:"end",className:"w-56",children:[e.jsx(W,{children:n("table_columns_settings")}),e.jsx(Z,{}),$.map(o=>e.jsx(ee,{checked:b(o.id),onCheckedChange:()=>z(o.id),onSelect:w=>w.preventDefault(),children:o.label},o.id))]})]})})]})]})}export{Oe as default};
