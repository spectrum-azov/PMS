import{j as e}from"./vendor-radix-ByHbWxx8.js";import{a as p}from"./vendor-react-BF0FEgLq.js";import{u as y,B as C,l as B,a as V,t as b}from"./index-0aCTP9xq.js";import{C as L,a as M,c as z,d as H}from"./card-Dst-uUJd.js";import{S as R,B as $}from"./badge-WuK-6-Ms.js";import{G as A,T as D,D as J}from"./DataTablePagination-Dg7qy-0E.js";import{S as K}from"./shield-DV-e7VlL.js";import{M as Q}from"./map-pin-BvZb6uaU.js";import{I as N}from"./input-BzJ4CQH1.js";import{L as h}from"./label-X5ZxR2EB.js";import{S as I,a as T,b as k,c as P,d as j}from"./select-DBeyWshw.js";import{G as W}from"./GenericDialog-3Ds61fFP.js";import"./vendor-charts-3qJ5OAaG.js";import"./chevron-left-BUxVMVdO.js";function X({units:d,paginatedUnits:u,getParentName:c,getTypeBadge:x,handleOpenDialog:t,handleDelete:r}){const{t:l}=y(),o=[{header:l("units_col_abbrev"),render:s=>e.jsx("span",{className:"font-medium text-primary font-mono",children:s.abbreviation||"—"})},{header:l("units_col_name"),render:s=>e.jsx("span",{className:"font-medium",children:s.name})},{header:l("units_col_type"),render:s=>x(s.type)},{header:l("units_col_parent"),render:s=>e.jsx("span",{className:"text-sm text-muted-foreground",children:c(s.parentId)})},{header:l("units_col_location"),render:s=>e.jsx("span",{className:"text-sm",children:s.location||"—"})}],a=s=>e.jsxs(L,{className:"overflow-hidden border-border bg-card hover:border-primary/50 transition-colors",children:[e.jsxs(M,{className:"p-4 pb-2 flex flex-row items-center justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(K,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-mono font-bold text-lg text-primary leading-tight",children:s.abbreviation||"—"}),e.jsx("div",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:s.type})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(C,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>t(s),children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx(C,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-destructive",onClick:()=>r(s.id),children:e.jsx(D,{className:"w-4 h-4"})})]})]}),e.jsxs(z,{className:"p-4 pt-2 space-y-4",children:[e.jsx("div",{className:"font-semibold text-foreground",children:s.name}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 bg-muted/30 p-3 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground mr-1",children:[l("units_col_parent"),":"]}),e.jsx("span",{className:"font-medium",children:c(s.parentId)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Q,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground mr-1",children:[l("units_col_location"),":"]}),e.jsx("span",{className:"font-medium",children:s.location||"—"})]})]})]})]});return e.jsx(A,{data:u,columns:o,onEdit:t,onDelete:s=>r(s.id),renderMobileCard:a,emptyMessage:l("units_empty"),idField:"id"})}function Y({isDialogOpen:d,setIsDialogOpen:u,editingUnit:c,units:x,formData:t,setFormData:r,handleOpenDialog:l,handleSubmit:o}){const{t:a}=y();return e.jsx(W,{isOpen:d,onOpenChange:u,title:a(c?"units_dialog_edit":"units_dialog_add"),onSubmit:o,onCancel:()=>u(!1),triggerLabel:a("units_add"),saveLabel:a(c?"common_update":"common_create"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"name",children:a("units_name")}),e.jsx(N,{id:"name",value:t.name||"",onChange:s=>r({...t,name:s.target.value}),placeholder:"Група мереж та ІТ",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"abbreviation",children:a("units_abbreviation")}),e.jsx(N,{id:"abbreviation",value:t.abbreviation||"",onChange:s=>r({...t,abbreviation:s.target.value}),placeholder:"IT",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"type",children:a("units_type")}),e.jsxs(I,{value:t.type,onValueChange:s=>r({...t,type:s}),children:[e.jsx(T,{className:"mt-1",children:e.jsx(k,{})}),e.jsxs(P,{children:[e.jsx(j,{value:"Частина",children:a("units_type_part")}),e.jsx(j,{value:"Відділ",children:a("units_type_dept")}),e.jsx(j,{value:"Група",children:a("units_type_group")})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"location",children:a("units_location")}),e.jsx(N,{id:"location",value:t.location||"",onChange:s=>r({...t,location:s.target.value}),placeholder:"Київ",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"parentId",children:a("units_parent")}),e.jsxs(I,{value:t.parentId||"none",onValueChange:s=>r({...t,parentId:s==="none"?void 0:s}),children:[e.jsx(T,{className:"mt-1",children:e.jsx(k,{placeholder:a("units_no_parent")})}),e.jsxs(P,{children:[e.jsx(j,{value:"none",children:a("units_no_parent")}),x.filter(s=>s.id!==(c==null?void 0:c.id)).map(s=>e.jsxs(j,{value:s.id,children:[s.abbreviation," - ",s.name]},s.id))]})]})]})]})})}function xe(){const{units:d,addUnit:u,updateUnit:c,deleteUnit:x}=V(),{t}=y(),[r,l]=p.useState(1),[o,a]=p.useState(10),s=Math.ceil(d.length/o),E=d.slice((r-1)*o,r*o),[G,f]=p.useState(!1),[v,w]=p.useState(null),[m,_]=p.useState({name:"",abbreviation:"",type:"Група",location:"",parentId:""}),S=n=>{n?(w(n),_(n)):(w(null),_({name:"",abbreviation:"",type:"Група",location:"",parentId:""})),f(!0)},O=async n=>{if(n.preventDefault(),!m.name){b.error(t("units_err_name_required"));return}if(v)await c(v.id,m)&&b.success(t("units_updated"));else{const i={id:`unit-${Date.now()}`,name:m.name,abbreviation:m.abbreviation,type:m.type,location:m.location,parentId:m.parentId||void 0};await u(i)&&b.success(t("units_added"))}f(!1)},U=async n=>{confirm(t("units_confirm_delete"))&&await x(n)&&b.success(t("units_deleted"))},q=n=>{if(!n)return"—";const i=d.find(g=>g.id===n);return(i==null?void 0:i.abbreviation)||(i==null?void 0:i.name)||"—"},F=n=>{const i={Частина:"bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-100",Відділ:"bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-100",Група:"bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-100"},g=n==="Частина"?t("units_type_part"):n==="Відділ"?t("units_type_dept"):n==="Група"?t("units_type_group"):n||t("common_not_specified");return e.jsx($,{variant:"secondary",className:i[n||""]||"",children:g})};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-semibold text-foreground",children:t("units_title")}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[t("units_subtitle")," ",e.jsx("span",{className:"font-medium",children:d.length})]})]}),e.jsx(Y,{isDialogOpen:G,setIsDialogOpen:f,editingUnit:v,units:d,formData:m,setFormData:_,handleOpenDialog:S,handleSubmit:O})]}),e.jsxs(L,{children:[e.jsx(M,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),t("units_list")]})})}),e.jsxs(z,{children:[e.jsx(X,{units:d,paginatedUnits:E,getParentName:q,getTypeBadge:F,handleOpenDialog:S,handleDelete:U}),s>0&&e.jsx(J,{currentPage:r,setCurrentPage:l,pageSize:o,setPageSize:a,totalPages:s})]})]})]})}export{xe as default};
